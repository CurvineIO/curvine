syntax = "proto2";
package proto;

option java_package = "io.curvine.proto";
option java_multiple_files = true;
option java_outer_classname = "MountProto";

import "common.proto";

message MountPointInfo {
    required string curvine_path = 1;
    required string ufs_path = 2;
    required uint32 mount_id = 3;
    map<string, string> properties = 4;
    required bool auto_cache = 5;
    optional uint64 cache_ttl_secs = 6;
    required ConsistencyConfig consistency_config = 7;
    required StorageTypeProto storage_type = 8;
    required uint64 block_size = 9;
    required uint32 replicas = 10;
}

message MountOptions {
    required bool update = 1 [default = false];
    map<string, string> properties = 2;
    required bool auto_cache = 3 [default = false];
    optional uint64 cache_ttl_secs = 4;
    optional ConsistencyConfig consistency_config = 5;
    optional StorageTypeProto storage_type = 6 [default = STORAGE_TYPE_PROTO_DISK];
    optional uint64 block_size = 7 [default = 134217728];
    optional uint32 replicas = 8 [default = 1];
}

enum ConsistencyStrategy {
    None = 0;
    Always = 1;
    Period = 2;
}

message ConsistencyConfig {
    required ConsistencyStrategy strategy = 1 [default = None];
    optional uint64 period_seconds = 2; // Only used when strategy is Periodically
}

message MountRequest {
    required string curvine_path = 1;
    required string ufs_path = 2;
    optional MountOptions mount_options = 3;
}

message MountResponse {
}

message UnMountOptions {
    map<string, string> properties = 1;
}

message UnMountRequest {
    required string curvine_path = 1;
    optional UnMountOptions unmount_options = 2;
}

message UnMountResponse {
}

message GetMountTableRequest {}

message GetMountTableResponse {
    repeated MountPointInfo mount_points = 1;
}

message GetMountPointInfoRequest {
    required string path = 1;
}

message GetMountPointInfoResponse {
    optional MountPointInfo mount_point = 1;
}