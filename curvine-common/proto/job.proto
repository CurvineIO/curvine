syntax = "proto2";
package proto;

option java_package = "io.curvine.proto";
option java_multiple_files = true;
option java_outer_classname = "LoadProto";

import "common.proto";

// job and task status enumeration
enum JobTaskStateProto {
  UNKNOWN = 0;
  PENDING = 1;
  LOADING = 2;
  COMPLETED = 3;
  FAILED = 4;
  CANCELED = 5;
}

enum JobTaskTypeProto {
  LOAD = 1;
}

message JobTaskProgressProto {
  required int64 loaded_size = 1;
  required int64 total_size = 2;
  required int64 update_time = 3;
  required int32 state = 4;
  required string message = 5;
}


// Submit a load job request
message SubmitJobRequest {
  required JobTaskTypeProto job_type = 1;
  required bytes job_command = 2;
}

// Submit the load job response
message SubmitJobResponse {
  required string job_id = 1;
  required string target_path = 2;
}

// Cancel the job request
message CancelJobRequest {
  required string job_id = 1;
}

// Cancel the job response
message CancelJobResponse {
}

message GetJobStatusRequest {
  required string job_id = 1;
  required bool verbose = 2 [default = false];
}

message GetJobStatusResponse {
  required string job_id = 1;
  required JobTaskStateProto state = 2;
  required string source_path = 3;
  required string target_path = 4;
  required JobTaskProgressProto progress = 5;

}

message SubmitTaskRequest {
  required JobTaskTypeProto task_type = 1;
  required bytes task_command = 2;
}

message SubmitTaskResponse {
  required string task_id = 1;
}

message TaskReportRequest {
  required string job_id = 1;
  required string task_id = 2;
  required JobTaskProgressProto report = 3;
}

message TaskReportResponse {
}